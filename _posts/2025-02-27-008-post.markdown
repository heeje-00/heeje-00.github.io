---
layout: post
title: "DTFT"
date: 2025-02-27 9:00:00 +0900
categories: jekyll
mathjax: true
---

## **8. 이산시간 푸리에 변환(DTFT)**

안녕하세요 !

이번에는 이산시간 푸리에 변환 (Discrete Time Fourier Transform)에 대해 알아보겠습니다.

DTFT는 말 그래도 이산 신호를 푸리에 변환 하는 것입니다.

이전에는 두 가지를 해봤죠?

하나는 푸리에 급수, 즉 연속적인 주기함수를 이산적인 주파수공간으로 대응시켰습니다.

두번째는 푸리에 변환, 즉 연속 신호 함수를 연속적인 주파수공간으로 대응시켰습니다.

이번에는 DTFT 즉, 이산신호를 연속적인 주파수 공간으로 대응시켜보겠습니다.

이산신호의 표현방식은 연속신호를 샘플링하면 되겠죠. 

---

### **이산신호의 표현**

이전에도 알아봤듯이 이산신호는 다음과 같이 $ x[n] $ 으로 표현할 수 있습니다. 
 
또한 푸리에 변환을 가져와보죠.

$$
X(f) = \int_{-\infty}^{\infty} x(t)e^{-i2\pi ft} dt
$$

여기서 신호는 이산신호이므로 $ x(t) -> x[n] $ 이고 $ 2\pi f = \omega $ 로 바꿔서 표현하면

$$
X(\omega) = \sum_{-\infty}^{\infty} x[n]e^{-i\omega n}
$$

식을 보면 알 수 있듯이 푸리에 변환을 그냥 이산화 시킨 것에 불과합니다.

이산화된 신호만을 가지고 푸리에 변환을 하는 거죠 

---

### **직교성** 

그렇다면 푸리에 급수와 마찬가지로 서로 다른 $ e^{i\omega n} $ 도 직교할까요?

직교성이 중요한 이유는 선형대수에서 기저벡터를 찾듯이 각각의 주기함수도 기저벡터처럼 독립적이어야 하기 때문입니다.

그래서 주기 N을 가지는 이산 신호 $ \phi_{k}[n] $ 와 $ \phi_{p}[n] $ 가 직교한다는 것은 다음을 만족해야 합니다.

$$
\sum_{n = 0}^{N - 1} \phi_{k}[n]\phi_{p}^{*}[n] = 0
$$

위 식은 다음과 같습니다.

$$
\sum_{n = 0}^{N - 1}exp\left(i\frac{2\pi k}{N}n\right)exp\left(-i\frac{2\pi p}{N}n\right)
$$

$$
= \sum_{n = 0}^{N - 1} exp\left(i\frac{2\pi (k - p)}{N}n \right)
$$

$$
= \sum_{n = 0}^{N - 1} \left[exp\left(i\frac{2\pi (k - p)}{N} \right)\right]^n
$$

자 그러면 위 식은 등비수열의 합공식이라는 것을 알 수 있습니다. 

먼저, $ k = p $ 인 경우는 $ e^0 = 1 $이므로

$$
\sum_{n = 0}^{N - 1} \left[exp\left(i\frac{2\pi (0)}{N} \right)\right]^n = N
$$

$ N $ 이 나오네요. 

중요한 것은 $ k \neq p $ 인 경우에 직교성이 성립하는 가 입니다.

등비수열의 합 공식은 다음과 같습니다.

$$
S_{n} = a\left(\frac{1 - r^{n}}{1 - r}\right)
$$

여기에 대입해주면 다음과 같습니다.

$$
\frac{1 - \left(exp\left(i\frac{2\pi (k - p)}{N} \right)\right)^N}{1 - \left(exp\left(i\frac{2\pi (k - p)}{N} \right)\right)}
$$

여기서 $ N $ 승을 $ exp $ 안으로 넣어주면 

$$
\frac{1 - exp\left(i2\pi (k - p) \right)}{1 - exp\left(i\frac{2\pi (k - p)}{N} \right)}
$$

$ k \neq p $ 이기 때문에

$$
exp\left(i2\pi (k - p) \right) = 1
$$

이렇게 돼서 결국,

$$
\frac{1 - 1}{1 - exp\left(i\frac{2\pi (k - p)}{N} \right)} = 0
$$

따라서 $ k \neq p $ 일 때, 직교성이 성립하는 것을 확인할 수 있습니다.

### **이산 푸리에 급수 공식 유도**

자 이제 직교성을 통해서 $ x[n] $ 을 $ exp(i\frac{2\pi k}{N}n) $ 의 합으로 나타낼 수 있다는 것을 보였습니다.

따라서 주기가 N인 이산신호 $ x[n] $ 에 대하여

$$
x[n] = x[n + N]
$$

$$
x[n] = \sum_{k = 0}^{N - 1} a_{k}exp(i\frac{2\pi k}{N}n)
$$

위와 같이 표현가능 하고 이제 $ a_k $ 를 구해야 합니다.

직교성의 성질을 이용해서 켤레 복소수인 $ exp(-i\frac{2\pi r}{N}n) $ 를 곱하는 것을 통해 $ a_k $ 룰 구할 수 있습니다.

왜냐하면 $ x[n] $ 은 $ exp(i\frac{2\pi k}{N}n) $ 의 합이고

각각의 항의 크기는 내적과 비슷하게 켤레 복소수를 곱함으로써 구해지기 때문입니다.

그래서 $ x[n] $ 에 켤레 복소수 $ \phi_{r}^{*} $ 를 곱해서 a_k를 유도해 보겠습니다.

$$
a_r = \sum_{n = 0}^{N - 1} x[n]\phi_{r}^{*}[n]
$$

위 식의 의미는 $ x[n] $ 에서 $ \phi_{r}[n] $ 의 계수를 추출하는 것입니다.

모든 n 값에 대한 r에 대한 계수의 합이 $ a_r $ 이 되는 것이죠.

따라서 식을 다시 정리하면

$$
a_r = \sum_{n = 0}^{N - 1} \left(\sum_{k = 0}^{N - 1} a_{k}\phi_{k}[n] \right)\phi_{r}^{*}[n]
$$

$$
= \sum_{k = 0}^{N - 1}a_k\sum_{n = 0}^{N - 1} \phi_{k}[n]\phi_{r}^{*}[n]
$$

위 식에서 보면 아까 직교성에서 구했듯이 $ k = r $ 일 때만 1이 됩니다. 

따라서 이산 임펄스 함수로 표현 할 수 있겠죠

그리고 이것이 N번 더해지니 N이 곱해지게됩니다.

$$
= \sum_{k = 0}^{N - 1}a_{k}N\delta[k - r]
$$

여기서 보면 $ k $ 도 $ 0 ~ N -1 $ 의 범위를 가지겠지만 $ r $ 도 같습니다.

따라서 $ r $ 이 뭐든 간에 $ k $ 랑 같은 값은 하나만 존재합니다.

$$
= Na_{k}
$$

정리하면 다음과 같습니다.

$$
a_r = Na_{k} (r = k 일때)
$$

$$
a_{k} = \frac{1}{N} \sum_{n = 0}^{N - 1} x[n]\phi_{k}^{*}[n]
$$

$$
a_{k} = \frac{1}{N} \sum_{n = 0}^{N - 1} x[n]exp\left(-i\frac{2\pi k}{N}n\right)\ for\ k\ = 0, 1, ⋯ , N - 1
$$


